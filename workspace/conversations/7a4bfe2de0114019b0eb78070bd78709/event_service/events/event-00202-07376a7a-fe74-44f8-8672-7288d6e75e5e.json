{"kind": "ObservationEvent", "id": "07376a7a-fe74-44f8-8672-7288d6e75e5e", "timestamp": "2025-09-26T01:39:28.042696", "source": "environment", "tool_name": "execute_bash", "tool_call_id": "toolu_01PV9ZFtqM7MCHETP97Gjvy7", "observation": {"kind": "ExecuteBashObservation", "output": "diff --git a/astropy/io/fits/diff.py b/astropy/io/fits/diff.py\nindex 100cdf1b8c..d3608ef01d 100644\n--- a/astropy/io/fits/diff.py\n+++ b/astropy/io/fits/diff.py\n@@ -1449,7 +1449,7 @@ class TableDataDiff(_BaseDiff):\n                 arrb.dtype, np.floating\n             ):\n                 diffs = where_not_allclose(arra, arrb, rtol=self.rtol, atol=self.atol)\n-            elif \"P\" in col.format:\n+            elif \"P\" in col.format or \"Q\" in col.format:\n                 diffs = (\n                     [\n                         idx\ndiff --git a/astropy/io/fits/tests/test_diff.py b/astropy/io/fits/tests/test_diff.py\nindex adfebe6a5b..e01e014174 100644\n--- a/astropy/io/fits/tests/test_diff.py\n+++ b/astropy/io/fits/tests/test_diff.py\n@@ -601,6 +601,33 @@ class TestDiff(FitsTestCase):\n         assert \"13 different table data element(s) found (65.00% different)\" in report\n         assert report.count(\"more indices\") == 1\n\n+    def test_identical_vla_tables(self):\n+        \"\"\"\n+        Test that identical VLA (variable-length array) tables are correctly\n+        identified as identical. This is a regression test for a bug where\n+        Q format VLA columns were incorrectly reported as different when\n+        comparing a file to itself.\n+        \"\"\"\n+        # Test Q format VLA columns (the original bug case)\n+        col_qd = Column(\"QD_COL\", format=\"QD\", array=[[0.0], [0.0, 0.0]])\n+        col_qi = Column(\"QI_COL\", format=\"QI\", array=[[1], [1, 2]])\n+        col_qe = Column(\"QE_COL\", format=\"QE\", array=[[1.0], [1.0, 2.0]])\n+\n+        # Test P format VLA columns (should continue to work)\n+        col_pd = Column(\"PD_COL\", format=\"PD()\", array=[[3.0], [3.0, 4.0]])\n+\n+        # Create table with VLA columns\n+        hdu = BinTableHDU.from_columns([col_qd, col_qi, col_qe, col_pd])\n+\n+        # Test that identical VLA data is correctly identified as identical\n+        diff = TableDataDiff(hdu.data, hdu.data)\n+        assert diff.identical, \"Identical VLA tables should be reported as identical\"\n+\n+        # Test with file I/O (the original bug scenario)\n+        hdu.writeto(self.temp(\"vla_test.fits\"))\n+        file_diff = FITSDiff(self.temp(\"vla_test.fits\"), self.temp(\"vla_test.fits\"))\n+        assert file_diff.identical, \"Identical VLA files should be reported as identical\"\n+\n     def test_identical_files_basic(self):\n         \"\"\"Test identicality of two simple, extensionless files.\"\"\"", "command": "cd /tmp/tmp1_6k5dg_/astropy && git diff", "error": false, "timeout": false, "metadata": {"exit_code": 0, "pid": -1, "username": "juan-all-hands", "hostname": "juan-dev", "working_dir": "/tmp/tmp1_6k5dg_/astropy", "py_interpreter_path": "/home/juan-all-hands/v1/benchmarks/.venv/bin/python", "prefix": "", "suffix": "\n[The command completed with exit code 0.]"}}, "action_id": "e66af524-d6f6-457b-a140-9594a486cef5"}